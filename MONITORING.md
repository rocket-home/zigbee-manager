# üì° –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ Zigbee2MQTT

## üéØ –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –°–æ–±—ã—Ç–∏—è —Å–µ—Ç–∏
- –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –°—Ç–∞—Ç—É—Å permit_join

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ë–∞–∑–æ–≤—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ–ª—å–∫–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
make monitor-devices
```

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –í—Å–µ MQTT —Å–æ–æ–±—â–µ–Ω–∏—è
make monitor-devices-all
```

```bash
# –° —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É
make monitor-devices-filter FILTER=join
```


```

## üìã –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π

### üéâ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

```
[14:30:25] üéâ –ù–û–í–û–ï –£–°–¢–†–û–ô–°–¢–í–û –ü–û–î–ö–õ–Æ–ß–ï–ù–û!
   üì± –î–µ—Ç–∞–ª–∏: {"data":{"friendly_name":"0x00158d0009b1b2b3","ieee_address":"0x00158d0009b1b2b3"},"type":"device_joined"}
```

### üëã –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

```
[14:35:10] üëã –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ—Ç–∫–ª—é—á–µ–Ω–æ
   üì± –î–µ—Ç–∞–ª–∏: {"data":{"friendly_name":"0x00158d0009b1b2b3","ieee_address":"0x00158d0009b1b2b3"},"type":"device_left"}
```

### üì¢ –û–±—ä—è–≤–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤

```
[14:32:15] üì¢ –û–±—ä—è–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
   üì± –î–µ—Ç–∞–ª–∏: {"data":{"friendly_name":"0x00158d0009b1b2b3"},"type":"device_announce"}
```

### üîê Permit Join —Å—Ç–∞—Ç—É—Å

```
[14:30:00] üîê Permit join —Å—Ç–∞—Ç—É—Å: true
```

### ‚ùå –û—à–∏–±–∫–∏

```
[14:30:05] ‚ùå –û—à–∏–±–∫–∞: Failed to join device
```

## üîß –û–ø—Ü–∏–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è

```bash
# –¢–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
make monitor-devices-filter FILTER=joined
```

```bash
# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
make monitor-devices-filter FILTER=error
```

```bash
# –¢–æ–ª—å–∫–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
make monitor-devices-filter FILTER=0x00158d0009b1b2b3
```

```bash
# –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
make monitor-devices-filter FILTER=join,left
```

```bash
# –í–∫–ª—é—á–µ–Ω–∏—è –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
make monitor-devices-filter FILTER=+join,-error
```

```bash
# –¢–æ–ª—å–∫–æ –∏—Å–∫–ª—é—á–µ–Ω–∏—è (–ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ, –∫—Ä–æ–º–µ)
make monitor-devices-filter FILTER=-permit,-announce
```

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å —Ñ–∏–ª—å—Ç—Ä–æ–≤:**
- `pattern` - –≤–∫–ª—é—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º
- `+pattern` - —è–≤–Ω–æ –≤–∫–ª—é—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º
- `-pattern` - –∏—Å–∫–ª—é—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º
- `pattern1,pattern2` - –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é



### –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–ø—Ü–∏–∏

```bash
# –§–∏–ª—å—Ç—Ä (—á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç)
cd scripts
./monitor-devices.sh --filter "join"
```

```bash
# –°–ª–æ–∂–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
./monitor-devices.sh --filter "+join,+left,-error,-permit"
```

### –ü—Ä–∏–º–µ—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤

```bash
# –¢–æ–ª—å–∫–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
FILTER=join,left

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –Ω–æ –Ω–µ –æ—à–∏–±–∫–∏
FILTER=+join,-error

# –í—Å–µ, –∫—Ä–æ–º–µ permit_join —Å–æ–æ–±—â–µ–Ω–∏–π
FILTER=-permit

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –Ω–æ –Ω–µ –æ—à–∏–±–∫–∏
FILTER=0x00158d0009b1b2b3,-error

# –¢–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (–Ω–µ –ª–æ–≥–∏)
FILTER=+device_joined,+device_left,+device_announce

# –ò—Å–∫–ª—é—á–∏—Ç—å –≤—Å–µ —Å–ª—É–∂–µ–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
FILTER=-permit,-announce,-response
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–º—ã–µ —Ç–æ–ø–∏–∫–∏

| –¢–æ–ø–∏–∫ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|
| `zigbee2mqtt/bridge/log` | –õ–æ–≥–∏ Zigbee2MQTT |
| `zigbee2mqtt/bridge/event` | –°–æ–±—ã—Ç–∏—è (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ) |
| `zigbee2mqtt/bridge/response` | –û—Ç–≤–µ—Ç—ã –Ω–∞ –∫–æ–º–∞–Ω–¥—ã |

## üéÆ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: –í–∫–ª—é—á–∏—Ç—å permit_join
make permit-join-enable
```

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 2: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
make monitor-devices
```

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: –ü–æ–¥–∫–ª—é—á–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∫ –ø–∏—Ç–∞–Ω–∏—é
# –¢–µ—Ä–º–∏–Ω–∞–ª 2: –ù–∞–±–ª—é–¥–∞—Ç—å –∑–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
```

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: –í—ã–∫–ª—é—á–∏—Ç—å permit_join
make permit-join-disable
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
make monitor-devices-all
```

```bash
# –ò–ª–∏ —Ñ–∏–ª—å—Ç—Ä –ø–æ –æ—à–∏–±–∫–∞–º
make monitor-devices-filter FILTER=error
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ç–∏

```bash
# –î–ª–∏—Ç–µ–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ñ–æ–Ω–µ
nohup make monitor-devices > monitoring.log 2>&1 &
```

```bash
# –ò–ª–∏ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º
nohup make monitor-devices-filter FILTER=join > join-monitoring.log 2>&1 &
```

## üîç –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞

- üü¢ **–ó–µ–ª–µ–Ω—ã–π** - –£—Å–ø–µ—à–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞)
- üîµ **–°–∏–Ω–∏–π** - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- üü° **–ñ–µ–ª—Ç—ã–π** - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–æ—Ç–∫–ª—é—á–µ–Ω–∏—è)
- üî¥ **–ö—Ä–∞—Å–Ω—ã–π** - –û—à–∏–±–∫–∏
- üü£ **–§–∏–æ–ª–µ—Ç–æ–≤—ã–π** - Permit join —Å—Ç–∞—Ç—É—Å

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –í —Ñ–∞–π–ª–µ .env
MQTT_BASE_TOPIC=zigbee2mqtt
MQTT_USER=your_username
MQTT_PASSWORD=your_password
```

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã

```bash
# –°–æ–∑–¥–∞—Ç—å –∞–ª–∏–∞—Å –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤
alias monitor-join='make monitor-devices-filter FILTER=join'
```

```bash
alias monitor-errors='make monitor-devices-filter FILTER=error'
```

```bash
alias monitor-device='make monitor-devices-filter FILTER=0x00158d0009b1b2b3'
```

## üÜò –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ —É–¥–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ MQTT –±—Ä–æ–∫–µ—Ä—É"

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
make status
```

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏—Å—Ç–µ–º—É
make start
```

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å MQTT
make test-mqtt
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π"

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è
make monitor-devices-all
```

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Zigbee2MQTT
make logs-zigbee
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è"

```bash
# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞
pkill -f "monitor-devices.sh"

# –ò–ª–∏ –Ω–∞–π—Ç–∏ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
ps aux | grep monitor-devices
kill <PID>
```

## üí° –°–æ–≤–µ—Ç—ã

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã** –¥–ª—è —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞ –Ω—É–∂–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Ctrl+C** –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ** –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
4. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ª–æ–≥–∏** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–±–ª–µ–º
5. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ü–≤–µ—Ç–æ–≤—É—é —Å—Ö–µ–º—É** –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

- `make permit-join-enable` - –í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `make permit-join-disable` - –í—ã–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `make logs-zigbee` - –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ Zigbee2MQTT
- `make status` - –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

---

**üéØ –£–¥–∞—á–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞!** 