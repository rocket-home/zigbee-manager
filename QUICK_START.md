# üöÄ Zigbee2MQTT + –û–±–ª–∞—á–Ω—ã–π MQTT

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- **–û–°**: Linux (Ubuntu 20.04+, Debian 11+)
- **RAM**: –º–∏–Ω–∏–º—É–º 2GB, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 4GB+
- **–î–∏—Å–∫**: –º–∏–Ω–∏–º—É–º 1GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
- **–°–µ—Ç—å**: –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—Ä–∞–∑–æ–≤

### –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ:
- **Zigbee –∞–¥–∞–ø—Ç–µ—Ä**: USB-–∞–¥–∞–ø—Ç–µ—Ä (CC2531, CC2530, CC2652P, –∏ –¥—Ä.) –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω
- **–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞**: Zigbee-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ:
- **Docker**: –≤–µ—Ä—Å–∏—è 20.10+ ([–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ](DOCKER_INSTALL.md))
- **Docker Compose**: –≤–µ—Ä—Å–∏—è 2.0+ (–≤—Ö–æ–¥–∏—Ç –≤ Docker)
- **Git**: –¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

---

### üìã –ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π Zigbee2MQTT —Å–µ—Ä–≤–µ—Ä
- ‚úÖ MQTT –±—Ä–æ–∫–µ—Ä –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –æ–±–ª–∞—á–Ω–æ–º—É MQTT
- ‚úÖ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö


---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
git clone https://github.com/rocket-home/zigbee-manager.git
cd zigbee-manager
make env                    # –°–æ–∑–¥–∞–µ—Ç .env –∏–∑ env.example
make setup                  # –û–±—ã—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã
# –ò–õ–ò
make secure-setup           # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
make cloud-mqtt-credentials # –í–≤–æ–¥ –∏–º–µ–Ω–∏ –∏ –ø–∞—Ä–æ–ª—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –æ–±–ª–∞—á–Ω–æ–º—É MQTT
AUTO=true make generate-configs && make restart
make status                 # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
# –û—Ç–∫—Ä—ã—Ç—å: http://localhost:8084
```

---

## üì± –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### –í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
```bash
# –ù–∞ 5 –º–∏–Ω—É—Ç
make permit-join-temp MINUTES=5

# –ò–ª–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ)
make permit-join-enable
```

### –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
make monitor-devices
```

---

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π
make start          # –ó–∞–ø—É—Å–∫
make stop           # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
make restart        # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
make status         # –°—Ç–∞—Ç—É—Å

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–ª–∞—á–Ω—ã–º MQTT
make cloud-mqtt-credentials    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
make cloud-mqtt-status         # –°—Ç–∞—Ç—É—Å –º–æ—Å—Ç–∞
make cloud-mqtt-test           # –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
make permit-join-enable        # –†–∞–∑—Ä–µ—à–∏—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
make permit-join-disable       # –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
make monitor-devices           # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
make backup-system NAME=backup # –ü–æ–ª–Ω–∞—è —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è
make restore-system            # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```

---

## üÜò –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –°–∏—Å—Ç–µ–º–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
```bash
make logs              # –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
make config-check      # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
make restart           # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
```

### –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–µ –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è:
```bash
make permit-join-enable    # –í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
make monitor-devices       # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤
```

### –û–±–ª–∞—á–Ω—ã–π MQTT –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
```bash
make cloud-mqtt-status     # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –º–æ—Å—Ç–∞
make cloud-mqtt-test       # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç
make cloud-mqtt-credentials # –ü–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```

### Zigbee –∞–¥–∞–ø—Ç–µ—Ä –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ USB —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
ls -la /dev/ttyACM* /dev/ttyUSB*

# –ù–∞–π—Ç–∏ –∞–¥–∞–ø—Ç–µ—Ä –≤ —Å–∏—Å—Ç–µ–º–µ
dmesg | grep -i tty

# –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ .env —Ñ–∞–π–ª–µ
nano .env
# –∏–ª–∏
code .env
# –∏–ª–∏
vim .env

# –ù–∞–π—Ç–∏ –∏ –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä–æ–∫—É:
# ZIGBEE_ADAPTER_PORT=/dev/ttyACM0
# –ù–∞ –≤–∞—à –ø–æ—Ä—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä:
# ZIGBEE_ADAPTER_PORT=/dev/ttyUSB0

# –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
AUTO=true make generate-configs

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏—Å—Ç–µ–º—É
make restart
```

**üí° –ö–∞–∫ –Ω–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç:**
```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∞–¥–∞–ø—Ç–µ—Ä –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
ls -la /dev/ttyACM* /dev/ttyUSB*

# –û–±—ã—á–Ω–æ –∞–¥–∞–ø—Ç–µ—Ä—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è –∫–∞–∫:
# /dev/ttyACM0  (CC2531, CC2652P)
# /dev/ttyUSB0  (CC2530, Sonoff Zigbee)
# /dev/ttyACM1  (–µ—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
ls -la /dev/ttyACM0
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: crw-rw---- 1 root dialout

# –ï—Å–ª–∏ –Ω–µ—Ç –ø—Ä–∞–≤, –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É dialout:
sudo usermod -aG dialout $USER
newgrp dialout
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ—Ä—Ç–∞–º–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–Ω—è—Ç—ã–µ –ø–æ—Ä—Ç—ã
sudo lsof -i :1883
sudo lsof -i :8084

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ –ø–æ—Ä—Ç–∞—Ö
sudo kill -9 <PID>
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- **[DOCKER_INSTALL.md](DOCKER_INSTALL.md)** - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –∏ Docker Compose
- **[README_USER.md](README_USER.md)** - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **[README.md](README.md)** - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **[MONITORING.md](MONITORING.md)** - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

---

## üéâ –ì–æ—Ç–æ–≤–æ!

**–í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç!** 

- üåê **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: http://localhost:8084
- ‚òÅÔ∏è **–û–±–ª–∞—á–Ω—ã–π MQTT**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è
- üì± **–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞**: –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ permit_join
- üîÑ **–î–∞–Ω–Ω—ã–µ**: —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –º–µ–∂–¥—É –ª–æ–∫–∞–ª—å–Ω—ã–º –∏ –æ–±–ª–∞—á–Ω—ã–º MQTT

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Å–≤–æ–∏ Zigbee —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞! üöÄ 